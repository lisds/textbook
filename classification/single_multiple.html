
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Simple and multiple regression &#8212; Introduction to Data Science</title>
    
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=1999514e3f237ded88cf" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=5115cc725059bd94278eecd172e13a965bf8f5a9" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.b7bb847fb20b106c3d81b95245e65545.min.css" />
    
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=9c920249402e914e316237a7dbc6769907cce411"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="canonical" href="https://lisds.github.io/textbook/classification/single_multiple.html" />
    <link rel="shortcut icon" href="../_static/dsfe_favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Cross-tabulation" href="../useful-pandas/crosstab.html" />
    <link rel="prev" title="Multiple regression" href="Multiple_Regression.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="60">
<!-- Checkboxes to toggle the left sidebar -->
<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation" aria-label="Toggle navigation sidebar">
<label class="overlay overlay-navbar" for="__navigation">
    <div class="visually-hidden">Toggle navigation sidebar</div>
</label>
<!-- Checkboxes to toggle the in-page toc -->
<input type="checkbox" class="sidebar-toggle" name="__page-toc" id="__page-toc" aria-label="Toggle in-page Table of Contents">
<label class="overlay overlay-pagetoc" for="__page-toc">
    <div class="visually-hidden">Toggle in-page Table of Contents</div>
</label>
<!-- Headers at the top -->
<div class="announcement header-item noprint"></div>
<div class="header header-item noprint"></div>

    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<!-- Sidebar -->
<div class="bd-sidebar noprint" id="site-navigation">
    <div class="bd-sidebar__content">
        <div class="bd-sidebar__top"><div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/dsfe_logo.png" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Introduction to Data Science</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Coding for data
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../intro/what-is-data-science.html">
   What is data science?
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../intro/why-data-science.html">
   Why Data Science?
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../intro/tools_techniques.html">
   Tools and techniques
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../intro/computational-tools.html">
     Computational Tools
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../intro/statistical-techniques.html">
     Statistical Techniques
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../intro/text-is-data.html">
   Text is data
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../intro/Plotting_the_Classics.html">
     Plotting the classics
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../intro/Literary_Characters.html">
     Literary characters
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../intro/Another_Kind_Of_Character.html">
     Another kind of character
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../intro/surviving_computers.html">
   Surviving the computer
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../intro/the_software.html">
   Our tools
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../intro/using_jupyter.html">
   Using Jupyter notebooks
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../intro/more_on_jupyter.html">
   More on the Jupyter notebook
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  On code
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../code-basics/to_code.html">
   Ode to code
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../code-basics/sampling_problem.html">
   A sampling problem
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../code-basics/three_girls.html">
   A simpler problem
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../code-basics/variables_intro.html">
   Introduction to variables
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../code-basics/variables.html">
   Variables in code and mathematics
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../code-basics/Names.html">
   Names and variables
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../code-basics/Expressions.html">
   Expressions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../code-basics/functions.html">
   Introduction to functions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../code-basics/Calls.html">
   Call expressions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../code-basics/first_pass_three_girls.html">
   A first pass at the simple problem
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Data types
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../data-types/data_types.html">
   Types of things
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../data-types/Numbers.html">
   Numbers
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../data-types/Strings.html">
   Strings
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../data-types/strings_and_variables.html">
   Strings, variables and expressions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../data-types/String_Methods.html">
   String methods
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../data-types/Comparison.html">
   Comparisons
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../data-types/lists.html">
   Lists
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Arrays
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../arrays/Arrays.html">
   Arrays
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../arrays/Ranges.html">
   Ranges
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../arrays/More_on_Arrays.html">
   More on Arrays
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../arrays/array_indexing.html">
   Selecting values from an array
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../arrays/filling_arrays.html">
   Making and filling arrays.
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../arrays/function_arguments.html">
   Function arguments
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../arrays/rng_choice.html">
   Random choice
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../arrays/boolean_arrays.html">
   Boolean arrays
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../arrays/leaping_ahead.html">
   Leaping ahead
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Iteration
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../iteration/iteration.html">
   Iteration
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../iteration/indentation.html">
   Indentation, indentation, indentation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../iteration/reply_supreme.html">
   Reply to the Supreme Court
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../iteration/inference.html">
   Inference
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Data frames
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../data-frames/boolean_indexing.html">
   Indexing with Boolean arrays
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../data-frames/data_frames.html">
   Data frames
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../data-frames/data_frame_intro.html">
   Introduction to data frames
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../data-frames/df_series_arrays.html">
   Data frames, Series and arrays
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../data-frames/missing_values.html">
   Missing values
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../data-frames/df_plotting.html">
   Pandas plotting methods
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Population and permutation
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../permutation/population_permutation.html">
   Population and permutation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../permutation/permutation_idea.html">
   The idea of permutation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../permutation/permutation_and_t_test.html">
   Permutation and the t-test
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  More building blocks
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../functions-conditionals/more_building_blocks.html">
   More building blocks
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../functions-conditionals/introducing_functions.html">
   Introducing Functions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../functions-conditionals/none.html">
   On None
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../functions-conditionals/functions.html">
   Functions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../functions-conditionals/conditional_statements.html">
   Conditional Statements
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../functions-conditionals/functions_as_values.html">
   Functions as values
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../functions-conditionals/apply_functions.html">
   Apply functions
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Pandas, indices and labels
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../wild-pandas/pandas_indexing.html">
   Indexing in Pandas
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../wild-pandas/noble_politics.html">
   Noble politics and comparing counts
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../wild-pandas/safe_pandas.html">
   Handling Pandas safely
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../wild-pandas/text_encoding.html">
   Storing and loading text
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../wild-pandas/numbers_and_strings.html">
   Numbers and strings
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  The mean and straight lines
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../mean-slopes/mean.html">
   The mean
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../mean-slopes/mean_meaning.html">
   The meaning of the mean
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../mean-slopes/mean_and_slopes.html">
   The mean and slopes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../mean-slopes/sse_rmse.html">
   Sum of squares, room mean square
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../mean-slopes/optimization.html">
   Optimization
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../mean-slopes/finding_lines.html">
   Finding lines
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../mean-slopes/using_minimize.html">
   Using minimize
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../mean-slopes/inference_on_slopes.html">
   Inference on slopes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../mean-slopes/combining_boolean_arrays.html">
   Combining boolean arrays
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../mean-slopes/standard_scores.html">
   Standard scores
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../mean-slopes/Correlation.html">
   Correlation
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Classification
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="classification.html">
   Classification
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Nearest_Neighbors.html">
   Nearest neighbors
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Training_and_Testing.html">
   Training and testing
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Rows_of_Tables.html">
   Rows of tables
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Implementing_the_Classifier.html">
   Implementing the classifier
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Accuracy_of_the_Classifier.html">
   Accuracy of the classifier
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="Multiple_Regression.html">
   Multiple regression
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Simple and multiple regression
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Useful pandas
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../useful-pandas/crosstab.html">
   Cross-tabulation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../useful-pandas/groupby.html">
   The power of groupby
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../useful-pandas/merge.html">
   Merging
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  More on regression
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../more-regression/logistic_regression.html">
   Logistic regression
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Confidence
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../confidence/confidence.html">
   On confidence
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../confidence/bootstrap.html">
   The Bootstrap
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../confidence/havana_math.html">
   A problem for the education minister
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../confidence/Central_Limit_Theorem.html">
   The Central Limit Theorem
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../confidence/more_random_choice.html">
   More on random choices
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../confidence/large_numbers.html">
   The law of large numbers
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../confidence/laws_of_probability.html">
   Laws of probability
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../confidence/first_bayes.html">
   First Bayes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../confidence/bayes_theorem.html">
   Bayes theorem
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../confidence/bayes_bars.html">
   Bayes and bars
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../confidence/confident_treatment.html">
   Confident treatment
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../confidence/bayes_confidence.html">
   Bayes, confidence
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  The end of the beginning
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../end/end_of_beginning.html">
   The end of the beginning
  </a>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Extra pages
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../extra/extra.html">
   Notes
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../extra/more_on_lists.html">
   More on lists
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../extra/introducing_python.html">
   Introduction to Python
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../extra/brisk_python.html">
   Brisk introduction to Python
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../extra/pathlib.html">
   Using the
   <code class="docutils literal notranslate">
    <span class="pre">
     pathlib
    </span>
   </code>
   module
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../extra/monty_hall_lists.html">
   The Monty Hall problem, with lists
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../extra/data8_functions.html">
   Data 8 explanation of functions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../extra/mean_deviations.html">
   Why the differences from the mean must add to zero.
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../extra/mean_sq_deviations.html">
   The mean and squared differences
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../extra/slope_deviations.html">
   Mathematics for the least-squares slope
  </a>
 </li>
</ul>

    </div>
</nav></div>
        <div class="bd-sidebar__bottom">
             <!-- To handle the deprecated key -->
            
            <div class="navbar_extra_footer">
            Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
            </div>
            
        </div>
    </div>
    <div id="rtd-footer-container"></div>
</div>


          


          
<!-- A tiny helper pixel to detect if we've scrolled -->
<div class="sbt-scroll-pixel-helper"></div>
<!-- Main content -->
<div class="col py-0 content-container">
    
    <div class="header-article row sticky-top noprint">
        



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        
        <label for="__navigation"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="right"
title="Toggle navigation"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-bars"></i>
  </span>

</label>

        
    </div>
    <div class="header-article__right">
<div class="menu-dropdown menu-dropdown-launch-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Launch interactive content">
      <i class="fas fa-rocket"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://mybinder.org/v2/gh/lisds/textbook/main?urlpath=tree/classification/single_multiple.Rmd"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on Binder"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../_static/images/logo_binder.svg">
  </span>
<span class="headerbtn__text-container">Binder</span>
</a>

      </li>
      
      <li>
        <a href="https://ds.lis.2i2c.cloud/hub/user-redirect/git-pull?repo=https%3A//github.com/lisds/textbook&urlpath=tree/textbook/classification/single_multiple.Rmd&branch=main"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Launch on JupyterHub"
>
  

<span class="headerbtn__icon-container">
  
    <img src="../_static/images/logo_jupyterhub.svg">
  </span>
<span class="headerbtn__text-container">JupyterHub</span>
</a>

      </li>
      
      <li>
        
<button onclick="initThebeSBT()"
  class="headerbtn headerbtn-launch-thebe"
  data-toggle="tooltip"
data-placement="left"
title="Launch Thebe"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-play"></i>
  </span>
<span class="headerbtn__text-container">Live Code</span>
</button>

      </li>
      
    </ul>
  </div>
</div>

<button onclick="toggleFullScreen()"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>

<div class="menu-dropdown menu-dropdown-repository-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Source repositories">
      <i class="fab fa-github"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="https://github.com/lisds/textbook"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="headerbtn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="headerbtn__text-container">repository</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/lisds/textbook/issues/new?title=Issue%20on%20page%20%2Fclassification/single_multiple.html&body=Your%20issue%20content%20here."
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="headerbtn__text-container">open issue</span>
</a>

      </li>
      
      <li>
        <a href="https://github.com/lisds/textbook/edit/main/classification/single_multiple.Rmd"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Edit this page"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-pencil-alt"></i>
  </span>
<span class="headerbtn__text-container">suggest edit</span>
</a>

      </li>
      
    </ul>
  </div>
</div>

<div class="menu-dropdown menu-dropdown-download-buttons">
  <button class="headerbtn menu-dropdown__trigger"
      aria-label="Download this page">
      <i class="fas fa-download"></i>
  </button>
  <div class="menu-dropdown__content">
    <ul>
      <li>
        <a href="../_sources/classification/single_multiple.Rmd"
   class="headerbtn"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="headerbtn__text-container">.Rmd</span>
</a>

      </li>
      
      <li>
        
<button onclick="printPdf(this)"
  class="headerbtn"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="headerbtn__text-container">.pdf</span>
</button>

      </li>
      
    </ul>
  </div>
</div>
<label for="__page-toc"
  class="headerbtn headerbtn-page-toc"
  
>
  

<span class="headerbtn__icon-container">
  <i class="fas fa-list"></i>
  </span>

</label>

    </div>
</div>

<!-- Table of contents -->
<div class="col-md-3 bd-toc show noprint">
    <div class="tocsection onthispage pt-5 pb-3">
        <i class="fas fa-list"></i> Contents
    </div>
    <nav id="bd-toc-nav" aria-label="Page">
        <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#back-to-simple-regression">
   Back to simple regression
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#simple-regression">
   Simple regression
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#statsmodels">
   StatsModels
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#multiple-regression-in-steps">
   Multiple regression, in steps
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#multiple-regression-in-one-go">
   Multiple regression in one go
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#multiple-regression-in-3d">
   Multiple regression in 3D
  </a>
 </li>
</ul>

    </nav>
</div>
    </div>
    <div class="article row">
        <div class="col pl-md-3 pl-lg-5 content-container">
            <!-- Table of contents that is only displayed when printing the page -->
            <div id="jb-print-docs-body" class="onlyprint">
                <h1>Simple and multiple regression</h1>
                <!-- Table of contents -->
                <div id="print-main-content">
                    <div id="jb-print-toc">
                        
                        <div>
                            <h2> Contents </h2>
                        </div>
                        <nav aria-label="Page">
                            <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#back-to-simple-regression">
   Back to simple regression
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#simple-regression">
   Simple regression
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#statsmodels">
   StatsModels
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#multiple-regression-in-steps">
   Multiple regression, in steps
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#multiple-regression-in-one-go">
   Multiple regression in one go
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#multiple-regression-in-3d">
   Multiple regression in 3D
  </a>
 </li>
</ul>

                        </nav>
                    </div>
                </div>
            </div>
            <main id="main-content" role="main">
                
              <div>
                
  <section class="tex2jax_ignore mathjax_ignore" id="simple-and-multiple-regression">
<h1>Simple and multiple regression<a class="headerlink" href="#simple-and-multiple-regression" title="Permalink to this headline">#</a></h1>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="c1"># Safe setting for Pandas.  Needs Pandas version &gt;= 1.5.</span>
<span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;mode.copy_on_write&#39;</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span>

<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;fivethirtyeight&#39;</span><span class="p">)</span>

<span class="n">np</span><span class="o">.</span><span class="n">set_printoptions</span><span class="p">(</span><span class="n">suppress</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="cell tag_hide-cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">standard_units</span><span class="p">(</span><span class="n">any_numbers</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Convert any array of numbers to standard units.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">any_numbers</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">any_numbers</span><span class="p">))</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">any_numbers</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">correlation</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Correlation of columns `x` and `y` from data frame `t`</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">standard_units</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="n">x</span><span class="p">])</span> <span class="o">*</span> <span class="n">standard_units</span><span class="p">(</span><span class="n">t</span><span class="p">[</span><span class="n">y</span><span class="p">]))</span>
</pre></div>
</div>
</div>
</div>
<section id="back-to-simple-regression">
<h2>Back to simple regression<a class="headerlink" href="#back-to-simple-regression" title="Permalink to this headline">#</a></h2>
<p>The <a class="reference internal" href="Multiple_Regression.html"><span class="doc std std-doc">multiple regression</span></a> page introduced an extension the
simple regression methods we saw in the <a class="reference internal" href="../mean-slopes/finding_lines.html"><span class="doc std std-doc">finding
lines</span></a> page, and those following.</p>
<p>Simple regression uses a single set of predictor values, and a straight line,
to predict another set of values.</p>
<p>For example, in the finding lines page above, we predicted the “quality” scores
(on the y-axis) from the “easiness” scores (on the x-axis).</p>
<p>Multiple regression takes this a step further.  Now we use more than on sets of
values to predict another set of values.  For example, in the multiple
regression page, we used many sets of values, such as first and second floor
area, lot area, and others, in order to predict the house sale price.</p>
<p>The multiple regression page followed on directly from the classification
pages; we used multiple regression to build a model of house prices, from the
training set, and then predicted house prices in the testing set.</p>
<p>In this page we go back a little, to simple regression, and show how it relates
to the multiple regression we have just done.</p>
<p>On the way, we will start using a standard statistics library in Python, called
StatsModels.</p>
</section>
<section id="simple-regression">
<h2>Simple regression<a class="headerlink" href="#simple-regression" title="Permalink to this headline">#</a></h2>
<p>Let us return to simple regression - using one set of values (on the x axis) to
predict another set of values (on the y axis).</p>
<p>Here is our familiar <a class="reference internal" href="../data/chronic_kidney_disease.html"><span class="doc std std-doc">chronic kidney disease
dataset</span></a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ckd</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;ckd.csv&#39;</span><span class="p">)</span>
<span class="n">ckd</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Age</th>
      <th>Blood Pressure</th>
      <th>Specific Gravity</th>
      <th>Albumin</th>
      <th>Sugar</th>
      <th>Red Blood Cells</th>
      <th>Pus Cell</th>
      <th>Pus Cell clumps</th>
      <th>Bacteria</th>
      <th>Blood Glucose Random</th>
      <th>...</th>
      <th>Packed Cell Volume</th>
      <th>White Blood Cell Count</th>
      <th>Red Blood Cell Count</th>
      <th>Hypertension</th>
      <th>Diabetes Mellitus</th>
      <th>Coronary Artery Disease</th>
      <th>Appetite</th>
      <th>Pedal Edema</th>
      <th>Anemia</th>
      <th>Class</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>48</td>
      <td>70</td>
      <td>1.005</td>
      <td>4</td>
      <td>0</td>
      <td>normal</td>
      <td>abnormal</td>
      <td>present</td>
      <td>notpresent</td>
      <td>117</td>
      <td>...</td>
      <td>32</td>
      <td>6700</td>
      <td>3.9</td>
      <td>yes</td>
      <td>no</td>
      <td>no</td>
      <td>poor</td>
      <td>yes</td>
      <td>yes</td>
      <td>1</td>
    </tr>
    <tr>
      <th>1</th>
      <td>53</td>
      <td>90</td>
      <td>1.020</td>
      <td>2</td>
      <td>0</td>
      <td>abnormal</td>
      <td>abnormal</td>
      <td>present</td>
      <td>notpresent</td>
      <td>70</td>
      <td>...</td>
      <td>29</td>
      <td>12100</td>
      <td>3.7</td>
      <td>yes</td>
      <td>yes</td>
      <td>no</td>
      <td>poor</td>
      <td>no</td>
      <td>yes</td>
      <td>1</td>
    </tr>
    <tr>
      <th>2</th>
      <td>63</td>
      <td>70</td>
      <td>1.010</td>
      <td>3</td>
      <td>0</td>
      <td>abnormal</td>
      <td>abnormal</td>
      <td>present</td>
      <td>notpresent</td>
      <td>380</td>
      <td>...</td>
      <td>32</td>
      <td>4500</td>
      <td>3.8</td>
      <td>yes</td>
      <td>yes</td>
      <td>no</td>
      <td>poor</td>
      <td>yes</td>
      <td>no</td>
      <td>1</td>
    </tr>
    <tr>
      <th>3</th>
      <td>68</td>
      <td>80</td>
      <td>1.010</td>
      <td>3</td>
      <td>2</td>
      <td>normal</td>
      <td>abnormal</td>
      <td>present</td>
      <td>present</td>
      <td>157</td>
      <td>...</td>
      <td>16</td>
      <td>11000</td>
      <td>2.6</td>
      <td>yes</td>
      <td>yes</td>
      <td>yes</td>
      <td>poor</td>
      <td>yes</td>
      <td>no</td>
      <td>1</td>
    </tr>
    <tr>
      <th>4</th>
      <td>61</td>
      <td>80</td>
      <td>1.015</td>
      <td>2</td>
      <td>0</td>
      <td>abnormal</td>
      <td>abnormal</td>
      <td>notpresent</td>
      <td>notpresent</td>
      <td>173</td>
      <td>...</td>
      <td>24</td>
      <td>9200</td>
      <td>3.2</td>
      <td>yes</td>
      <td>yes</td>
      <td>yes</td>
      <td>poor</td>
      <td>yes</td>
      <td>yes</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 25 columns</p>
</div></div></div>
</div>
<p>In our case, we restrict ourselves to the chronic kidney disease patients.
These patients have a <code class="docutils literal notranslate"><span class="pre">1</span></code> in the <code class="docutils literal notranslate"><span class="pre">Class</span></code> column.</p>
<p>We’re also going to restrict ourselves to looking at the following measures:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Serum</span> <span class="pre">Creatinine</span></code>: a measure of how well the kidney is clearing substances
from the blood.  When creatinine is high, it means the kidney is not clearing
well.  This is the general measure of kidney disease that we are interested
to predict.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Blood</span> <span class="pre">Urea</span></code>: another measure of the ability of the kidney to clear
substances from the blood.  Urea is high in the blood when the kidneys are
not clearing efficiently.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Hemoglobin</span></code>: healthy kidneys release a hormone <em>erythropoietin</em> that
stimulates production of red blood cells, and red blood cells contain the
<em>hemoglobin</em> molecule.  When the kidneys are damaged, they produce less
erythropoietin, so the body produces fewer red blood cells, and there is a
lower concentration of hemoglobin in the blood.</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Data frame restricted to kidney patients and columns of interest.</span>
<span class="n">ckdp</span> <span class="o">=</span> <span class="n">ckd</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span>
    <span class="n">ckd</span><span class="p">[</span><span class="s1">&#39;Class&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">1</span><span class="p">,</span>
    <span class="p">[</span><span class="s1">&#39;Serum Creatinine&#39;</span><span class="p">,</span> <span class="s1">&#39;Blood Urea&#39;</span><span class="p">,</span> <span class="s1">&#39;Hemoglobin&#39;</span><span class="p">]]</span>
<span class="c1"># Rename the columns with shorted names.</span>
<span class="n">ckdp</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Creatinine&#39;</span><span class="p">,</span> <span class="s1">&#39;Urea&#39;</span><span class="p">,</span> <span class="s1">&#39;Hemoglobin&#39;</span><span class="p">]</span>
<span class="n">ckdp</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Creatinine</th>
      <th>Urea</th>
      <th>Hemoglobin</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>3.8</td>
      <td>56</td>
      <td>11.2</td>
    </tr>
    <tr>
      <th>1</th>
      <td>7.2</td>
      <td>107</td>
      <td>9.5</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2.7</td>
      <td>60</td>
      <td>10.8</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4.1</td>
      <td>90</td>
      <td>5.6</td>
    </tr>
    <tr>
      <th>4</th>
      <td>3.9</td>
      <td>148</td>
      <td>7.7</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
<p>First let us look at the relationship of the urea levels and the creatinine:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ckdp</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="s1">&#39;Urea&#39;</span><span class="p">,</span> <span class="s1">&#39;Creatinine&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot: xlabel=&#39;Urea&#39;, ylabel=&#39;Creatinine&#39;&gt;
</pre></div>
</div>
<img alt="../_images/single_multiple_9_1.png" src="../_images/single_multiple_9_1.png" />
</div>
</div>
<p>There is a positive correlation between these sets of values; high urea and
high creatinine go together; both reflect the failure of the kidneys to clear
substances from the blood.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">correlation</span><span class="p">(</span><span class="n">ckdp</span><span class="p">,</span> <span class="s1">&#39;Urea&#39;</span><span class="p">,</span> <span class="s1">&#39;Creatinine&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.8458834154017618
</pre></div>
</div>
</div>
</div>
<p>Now recall our standard method of finding a straight line to match these two
attributes, where we choose our straight line to minimize the sum of squared
error between the straight line prediction of the <code class="docutils literal notranslate"><span class="pre">Creatinine</span></code> values from the
<code class="docutils literal notranslate"><span class="pre">Urea</span></code> values, and the actual values of <code class="docutils literal notranslate"><span class="pre">Creatinine</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">ss_any_line</span><span class="p">(</span><span class="n">c_s</span><span class="p">,</span> <span class="n">x_values</span><span class="p">,</span> <span class="n">y_values</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Sum of squares error for intercept, slope</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">c</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="n">c_s</span>
    <span class="n">predicted</span> <span class="o">=</span> <span class="n">c</span> <span class="o">+</span> <span class="n">x_values</span> <span class="o">*</span> <span class="n">s</span>
    <span class="n">error</span> <span class="o">=</span> <span class="n">y_values</span> <span class="o">-</span> <span class="n">predicted</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">error</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>We find the least-squares straight line, using an initial guess for the slope and intercept of <code class="docutils literal notranslate"><span class="pre">[0,</span> <span class="pre">0]</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">minimize</span>

<span class="n">initial_guess</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>

<span class="n">min_res</span> <span class="o">=</span> <span class="n">minimize</span><span class="p">(</span><span class="n">ss_any_line</span><span class="p">,</span>
                   <span class="n">initial_guess</span><span class="p">,</span>
                   <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">ckdp</span><span class="p">[</span><span class="s1">&#39;Urea&#39;</span><span class="p">],</span> <span class="n">ckdp</span><span class="p">[</span><span class="s1">&#39;Creatinine&#39;</span><span class="p">]))</span>
<span class="n">min_res</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>      fun: 212.2754081473815
 hess_inv: array([[ 0.00008734, -0.00000253],
       [-0.00000253,  0.00000158]])
      jac: array([0.00000763, 0.00211716])
  message: &#39;Desired error not necessarily achieved due to precision loss.&#39;
     nfev: 33
      nit: 3
     njev: 11
   status: 2
  success: False
        x: array([-0.08490862,  0.05524182])
</pre></div>
</div>
</div>
</div>
<p>In particular, our intercept and slope are:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">min_res</span><span class="o">.</span><span class="n">x</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([-0.08490862,  0.05524182])
</pre></div>
</div>
</div>
</div>
<p>Compare this to the function we minimized in the <a class="reference internal" href="Multiple_Regression.html"><span class="doc std std-doc">multiple
regression</span></a> page.  You may have noticed there, that our
function that we minimized for calculated the <em>root mean square error</em>.</p>
<p>The <em>root mean square error</em> is just the sum of squared error, as above,
divided by the number of elements in the sequence, and then applying the square
root.  Here’s our function above, using root mean square error:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">rmse_any_line</span><span class="p">(</span><span class="n">c_s</span><span class="p">,</span> <span class="n">x_values</span><span class="p">,</span> <span class="n">y_values</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Root mean square error for intercept, slope</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">c</span><span class="p">,</span> <span class="n">s</span> <span class="o">=</span> <span class="n">c_s</span>
    <span class="n">predicted</span> <span class="o">=</span> <span class="n">c</span> <span class="o">+</span> <span class="n">x_values</span> <span class="o">*</span> <span class="n">s</span>
    <span class="n">error</span> <span class="o">=</span> <span class="n">y_values</span> <span class="o">-</span> <span class="n">predicted</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">error</span> <span class="o">**</span> <span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p>Notice the difference is just in the last line of the function.  Notice too
that the sum of square error and the root mean squared error always go in the
same direction.  If we take any two pairs of intercept, slopes - say <code class="docutils literal notranslate"><span class="pre">c_s_1</span></code>
and <code class="docutils literal notranslate"><span class="pre">c_s_2</span></code>, then if the sum of squares error is smaller for <code class="docutils literal notranslate"><span class="pre">c_s_1</span></code> than
<code class="docutils literal notranslate"><span class="pre">c_s_2</span></code>, then so is the root mean squared error - and visa versa.</p>
<p>This means we can minimize on the root mean squared error, and we are
guaranteed to get the same result within calculation precision, as we would for
the sum of squared error.   The <code class="docutils literal notranslate"><span class="pre">c_s</span></code> pair minimizing the root mean square
error must be the same as the <code class="docutils literal notranslate"><span class="pre">c_s</span></code> minimizing the root mean squared error.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Minimizing the sum of squares error (again).</span>
<span class="n">min_ss</span> <span class="o">=</span> <span class="n">minimize</span><span class="p">(</span><span class="n">ss_any_line</span><span class="p">,</span>
                  <span class="n">initial_guess</span><span class="p">,</span>
                  <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">ckdp</span><span class="p">[</span><span class="s1">&#39;Urea&#39;</span><span class="p">],</span> <span class="n">ckdp</span><span class="p">[</span><span class="s1">&#39;Creatinine&#39;</span><span class="p">]))</span>
<span class="n">min_ss</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>      fun: 212.2754081473815
 hess_inv: array([[ 0.00008734, -0.00000253],
       [-0.00000253,  0.00000158]])
      jac: array([0.00000763, 0.00211716])
  message: &#39;Desired error not necessarily achieved due to precision loss.&#39;
     nfev: 33
      nit: 3
     njev: 11
   status: 2
  success: False
        x: array([-0.08490862,  0.05524182])
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Minimizing the root mean squares error.</span>
<span class="n">min_rmse</span> <span class="o">=</span> <span class="n">minimize</span><span class="p">(</span><span class="n">rmse_any_line</span><span class="p">,</span>
                    <span class="n">initial_guess</span><span class="p">,</span>
                    <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">ckdp</span><span class="p">[</span><span class="s1">&#39;Urea&#39;</span><span class="p">],</span> <span class="n">ckdp</span><span class="p">[</span><span class="s1">&#39;Creatinine&#39;</span><span class="p">]))</span>
<span class="n">min_rmse</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>      fun: 2.2218544954108195
 hess_inv: array([[ 8.23440421, -0.05728554],
       [-0.05728554,  0.00054516]])
      jac: array([ 0.        , -0.00000006])
  message: &#39;Optimization terminated successfully.&#39;
     nfev: 33
      nit: 7
     njev: 11
   status: 0
  success: True
        x: array([-0.0849082 ,  0.05524181])
</pre></div>
</div>
</div>
</div>
<p>It can be useful to use the root mean square error, because the sum of squared
errors can get very large when there are many observations, or relatively large
values.  Using the root mean square gives less extreme values that can be
easier for the <code class="docutils literal notranslate"><span class="pre">minimize</span></code> routine to deal with.</p>
<p>You have already seen for this special case, of the sum of squares (or root
mean squares) error, we can get the same answer directly with calculation.  We
used <code class="docutils literal notranslate"><span class="pre">linregress</span></code> from <code class="docutils literal notranslate"><span class="pre">scipy.stats</span></code> to do this calculation in earlier pages.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">linregress</span>

<span class="n">linregress</span><span class="p">(</span><span class="n">ckdp</span><span class="p">[</span><span class="s1">&#39;Urea&#39;</span><span class="p">],</span> <span class="n">ckdp</span><span class="p">[</span><span class="s1">&#39;Creatinine&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>LinregressResult(slope=0.05524183911456146, intercept=-0.08491111825351982, rvalue=0.845883415401762, pvalue=9.327350567383254e-13, stderr=0.005439919989116022, intercept_stderr=0.6680061444061487)
</pre></div>
</div>
</div>
</div>
<p>Notice that the slope and the intercept are the same as those from <code class="docutils literal notranslate"><span class="pre">minimize</span></code>
above, within the precision of the calculation, and that the <code class="docutils literal notranslate"><span class="pre">rvalue</span></code> above is
the same as the correlation:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">correlation</span><span class="p">(</span><span class="n">ckdp</span><span class="p">,</span> <span class="s1">&#39;Urea&#39;</span><span class="p">,</span> <span class="s1">&#39;Creatinine&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0.8458834154017618
</pre></div>
</div>
</div>
</div>
</section>
<section id="statsmodels">
<h2>StatsModels<a class="headerlink" href="#statsmodels" title="Permalink to this headline">#</a></h2>
<p>Now it is time to introduce a major statistics package in Python,
<a class="reference external" href="https://www.statsmodels.org">StatsModels</a>.</p>
<p>StatsModels does many statistical calculations; among them are simple and
multiple regression.  Statsmodels categorizes these types of simple linear
models as “ordinary least squares” (OLS).</p>
<p>Here we load the StatModels interface that uses Pandas data frames:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Get the Pandas interface to the StatsModels routines.</span>
<span class="kn">import</span> <span class="nn">statsmodels.formula.api</span> <span class="k">as</span> <span class="nn">smf</span>
</pre></div>
</div>
</div>
</div>
<p>Next we specify our model using a <em>formula</em>.  Read the <code class="docutils literal notranslate"><span class="pre">~</span></code> in the formula below
as “as a function of”.  So the formula specifies a linear (straight-line) model
predicting <code class="docutils literal notranslate"><span class="pre">Creatinine</span></code> <em>as a function of</em> <code class="docutils literal notranslate"><span class="pre">Urea</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">simple_model</span> <span class="o">=</span> <span class="n">smf</span><span class="o">.</span><span class="n">ols</span><span class="p">(</span><span class="n">formula</span><span class="o">=</span><span class="s2">&quot;Creatinine ~ Urea&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">ckdp</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Finally we <em>fit</em> the model, and show the summary of the model fit:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">simple_fit</span> <span class="o">=</span> <span class="n">simple_model</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="n">simple_fit</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table class="simpletable">
<caption>OLS Regression Results</caption>
<tr>
  <th>Dep. Variable:</th>       <td>Creatinine</td>    <th>  R-squared:         </th> <td>   0.716</td>
</tr>
<tr>
  <th>Model:</th>                   <td>OLS</td>       <th>  Adj. R-squared:    </th> <td>   0.709</td>
</tr>
<tr>
  <th>Method:</th>             <td>Least Squares</td>  <th>  F-statistic:       </th> <td>   103.1</td>
</tr>
<tr>
  <th>Date:</th>             <td>Tue, 15 Nov 2022</td> <th>  Prob (F-statistic):</th> <td>9.33e-13</td>
</tr>
<tr>
  <th>Time:</th>                 <td>20:06:53</td>     <th>  Log-Likelihood:    </th> <td> -95.343</td>
</tr>
<tr>
  <th>No. Observations:</th>      <td>    43</td>      <th>  AIC:               </th> <td>   194.7</td>
</tr>
<tr>
  <th>Df Residuals:</th>          <td>    41</td>      <th>  BIC:               </th> <td>   198.2</td>
</tr>
<tr>
  <th>Df Model:</th>              <td>     1</td>      <th>                     </th>     <td> </td>   
</tr>
<tr>
  <th>Covariance Type:</th>      <td>nonrobust</td>    <th>                     </th>     <td> </td>   
</tr>
</table>
<table class="simpletable">
<tr>
      <td></td>         <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P>|t|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>Intercept</th> <td>   -0.0849</td> <td>    0.668</td> <td>   -0.127</td> <td> 0.899</td> <td>   -1.434</td> <td>    1.264</td>
</tr>
<tr>
  <th>Urea</th>      <td>    0.0552</td> <td>    0.005</td> <td>   10.155</td> <td> 0.000</td> <td>    0.044</td> <td>    0.066</td>
</tr>
</table>
<table class="simpletable">
<tr>
  <th>Omnibus:</th>       <td> 2.409</td> <th>  Durbin-Watson:     </th> <td>   1.303</td>
</tr>
<tr>
  <th>Prob(Omnibus):</th> <td> 0.300</td> <th>  Jarque-Bera (JB):  </th> <td>   1.814</td>
</tr>
<tr>
  <th>Skew:</th>          <td> 0.503</td> <th>  Prob(JB):          </th> <td>   0.404</td>
</tr>
<tr>
  <th>Kurtosis:</th>      <td> 3.043</td> <th>  Cond. No.          </th> <td>    236.</td>
</tr>
</table><br/><br/>Notes:<br/>[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.</div></div>
</div>
<p>Notice that the <code class="docutils literal notranslate"><span class="pre">coeff</span></code> column towards the bottom of this output.  Sure enough,
StatsModels is doing the same calculation as <code class="docutils literal notranslate"><span class="pre">linregress</span></code>, and getting the same
answer as <code class="docutils literal notranslate"><span class="pre">minimize</span></code> with our least-squares criterion.  The ‘Intercept’ and
slope for ‘Urea’ are the same as those we have already seen with the other
methods.</p>
</section>
<section id="multiple-regression-in-steps">
<h2>Multiple regression, in steps<a class="headerlink" href="#multiple-regression-in-steps" title="Permalink to this headline">#</a></h2>
<p>Now we move on to trying to predict the <code class="docutils literal notranslate"><span class="pre">Creatinine</span></code> using the <code class="docutils literal notranslate"><span class="pre">Urea</span></code> <em>and</em> the
<code class="docutils literal notranslate"><span class="pre">Hemoglobin</span></code>.  The <code class="docutils literal notranslate"><span class="pre">Urea</span></code> values and <code class="docutils literal notranslate"><span class="pre">Hemoglobin</span></code> values contain different
information, so both values may be useful in predicting the <code class="docutils literal notranslate"><span class="pre">Creatinine</span></code>.</p>
<p>One way to use both values is to use them step by step - first use <code class="docutils literal notranslate"><span class="pre">Urea</span></code>, and
then use <code class="docutils literal notranslate"><span class="pre">Hemoglobin</span></code>.</p>
<p>First we predict the <code class="docutils literal notranslate"><span class="pre">Creatinine</span></code> using just the straight-line relationship we
have found for <code class="docutils literal notranslate"><span class="pre">Urea</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Use the RMSE line; but all our methods gave the same line.</span>
<span class="n">intercept</span><span class="p">,</span> <span class="n">slope</span> <span class="o">=</span> <span class="n">min_rmse</span><span class="o">.</span><span class="n">x</span>
<span class="n">creat_predicted</span> <span class="o">=</span> <span class="n">intercept</span> <span class="o">+</span> <span class="n">slope</span> <span class="o">*</span> <span class="n">ckdp</span><span class="p">[</span><span class="s1">&#39;Urea&#39;</span><span class="p">]</span>
<span class="n">errors</span> <span class="o">=</span> <span class="n">ckdp</span><span class="p">[</span><span class="s1">&#39;Creatinine&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="n">creat_predicted</span>
<span class="c1"># Show the first five errors</span>
<span class="n">errors</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>0    0.791367
1    1.374034
2   -0.529600
3   -0.786855
4   -4.190880
dtype: float64
</pre></div>
</div>
</div>
</div>
<p>We can also call these errors <em>residuals</em> in the sense they are the error
<em>remaining</em> after removing the (straight-line) effect of <code class="docutils literal notranslate"><span class="pre">Urea</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># We can also call the errors - residuals.</span>
<span class="n">residuals</span> <span class="o">=</span> <span class="n">errors</span>
</pre></div>
</div>
</div>
</div>
<p>The remaining root mean square error is:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Root mean square error</span>
<span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">residuals</span> <span class="o">**</span> <span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>2.2218544954108195
</pre></div>
</div>
</div>
</div>
<p>Now we want to see if we can predict these residuals with the <code class="docutils literal notranslate"><span class="pre">Hemoglobin</span></code>
values.  Let’s use these residuals as our new y values, and fit a predicting
line using <code class="docutils literal notranslate"><span class="pre">Hemoglobin</span></code>.</p>
<p>First plot the residuals (y) against the <code class="docutils literal notranslate"><span class="pre">Hemoglobin</span></code> (x):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">ckdp</span><span class="p">[</span><span class="s1">&#39;Hemoglobin&#39;</span><span class="p">],</span> <span class="n">residuals</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.collections.PathCollection at 0x7ff3fcfc0f10&gt;
</pre></div>
</div>
<img alt="../_images/single_multiple_41_1.png" src="../_images/single_multiple_41_1.png" />
</div>
</div>
<p>Then fit a line:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">min_rmse_hgb</span> <span class="o">=</span> <span class="n">minimize</span><span class="p">(</span><span class="n">rmse_any_line</span><span class="p">,</span>
                        <span class="n">initial_guess</span><span class="p">,</span>
                        <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">ckdp</span><span class="p">[</span><span class="s1">&#39;Hemoglobin&#39;</span><span class="p">],</span> <span class="n">residuals</span><span class="p">))</span>
<span class="n">min_rmse_hgb</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>      fun: 2.217536741027748
 hess_inv: array([[48.13946639, -4.69989885],
       [-4.69989885,  0.48101915]])
      jac: array([-0.00000003, -0.00000003])
  message: &#39;Optimization terminated successfully.&#39;
     nfev: 30
      nit: 7
     njev: 10
   status: 0
  success: True
        x: array([ 0.63010386, -0.06449528])
</pre></div>
</div>
</div>
</div>
<p>The results from minimize show that the line relating <code class="docutils literal notranslate"><span class="pre">Hemoglobin</span></code> and the
residuals has a negative slope, as we would expect; more severe kidney disease
leads to lower hemoglobin and higher creatinine.  The root mean square error
has hardly changed, suggesting that <code class="docutils literal notranslate"><span class="pre">Hemoglobin</span></code> does not predict much, once we
have allowed for the predictions using <code class="docutils literal notranslate"><span class="pre">Urea</span></code>.</p>
</section>
<section id="multiple-regression-in-one-go">
<h2>Multiple regression in one go<a class="headerlink" href="#multiple-regression-in-one-go" title="Permalink to this headline">#</a></h2>
<p>Here we build the machinery as we did in the <a class="reference internal" href="Multiple_Regression.html"><span class="doc std std-doc">multiple
regression</span></a> page.</p>
<p>In particular, we are going to find three parameters:</p>
<ul class="simple">
<li><p>An intercept;</p></li>
<li><p>A slope for the line relating <code class="docutils literal notranslate"><span class="pre">Urea</span></code> to <code class="docutils literal notranslate"><span class="pre">Creatinine</span></code>;</p></li>
<li><p>A slope for the line relating <code class="docutils literal notranslate"><span class="pre">Hemoglobin</span></code> to <code class="docutils literal notranslate"><span class="pre">Creatinine</span></code>.</p></li>
</ul>
<p>In the multiple regression page, we found our best-fit slopes using the
training set, but here we will use the whole dataset.</p>
<p>The multiple regression page did not allow for an intercept.  Here we do allow
for an intercept.</p>
<p>Otherwise, you will recognize much of this machinery from the multiple
regression page.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">predict</span><span class="p">(</span><span class="n">intercept</span><span class="p">,</span> <span class="n">slopes</span><span class="p">,</span> <span class="n">row</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Predict a value given an intercept, slopes and corresponding row values</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">intercept</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">slopes</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">row</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">rmse</span><span class="p">(</span><span class="n">intercept</span><span class="p">,</span> <span class="n">slopes</span><span class="p">,</span> <span class="n">attributes</span><span class="p">,</span> <span class="n">y_values</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; Root mean square error for prediction of `y_values` from `attributes`</span>

<span class="sd">    Use `intercept` and `slopes` multiplied by `attributes` to give prediction.</span>

<span class="sd">    `attributes` is a data frame with numerical attributes to predict from.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">errors</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y_values</span><span class="p">)):</span>
        <span class="n">predicted</span> <span class="o">=</span> <span class="n">predict</span><span class="p">(</span><span class="n">intercept</span><span class="p">,</span> <span class="n">slopes</span><span class="p">,</span> <span class="n">attributes</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
        <span class="n">actual</span> <span class="o">=</span> <span class="n">y_values</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
        <span class="n">errors</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="n">actual</span> <span class="o">-</span> <span class="n">predicted</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">errors</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p>Here we calculate the root mean square error for an intercept of 1, and slopes
for <code class="docutils literal notranslate"><span class="pre">Urea</span></code> and <code class="docutils literal notranslate"><span class="pre">Hemoglobin</span></code> of 0 and 0.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rmse</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">ckdp</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s1">&#39;Urea&#39;</span><span class="p">:],</span> <span class="n">ckdp</span><span class="p">[</span><span class="s1">&#39;Creatinine&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>6.28908245609285
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">rmse_for_params</span><span class="p">(</span><span class="n">params</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; RMSE for intercept, slopes contained in `params`</span>

<span class="sd">    `params[0]` is the intercept.  `params[1:]` are the slopes.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">intercept</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">slopes</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
    <span class="k">return</span> <span class="n">rmse</span><span class="p">(</span><span class="n">intercept</span><span class="p">,</span>
                <span class="n">slopes</span><span class="p">,</span>
                <span class="n">ckdp</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s1">&#39;Urea&#39;</span><span class="p">:],</span>
                <span class="n">ckdp</span><span class="p">[</span><span class="s1">&#39;Creatinine&#39;</span><span class="p">]</span>
               <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Now we can get minimize to find the intercept and two slopes that minimize the
root mean square error (and the sum of squared error):</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">min_css</span> <span class="o">=</span> <span class="n">minimize</span><span class="p">(</span><span class="n">rmse_for_params</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="n">min_css</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>      fun: 2.215537202369422
 hess_inv: array([[105.21561398,  -0.21552247,  -8.23746781],
       [ -0.21552247,   0.00079991,   0.01344764],
       [ -8.23746781,   0.01344764,   0.70013041]])
      jac: array([-0.00000003, -0.00000039,  0.        ])
  message: &#39;Optimization terminated successfully.&#39;
     nfev: 80
      nit: 14
     njev: 20
   status: 0
  success: True
        x: array([ 1.02389185,  0.05345681, -0.09432157])
</pre></div>
</div>
</div>
</div>
<p>In fact, we can do this calculation more quickly, and without using a loop, by
using array calculations.  Don’t worry about the details of the function below;
as you will soon see, it does the same calculation as the <code class="docutils literal notranslate"><span class="pre">rmse</span></code> function
above.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">rmse_fast</span><span class="p">(</span><span class="n">intercept</span><span class="p">,</span> <span class="n">slopes</span><span class="p">,</span> <span class="n">attributes</span><span class="p">,</span> <span class="n">y_values</span><span class="p">):</span>
    <span class="c1"># Make an n by s array of slopes by copying the s slopes array n times.</span>
    <span class="n">slopes_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">tile</span><span class="p">(</span><span class="n">slopes</span><span class="p">,</span> <span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">y_values</span><span class="p">),</span> <span class="mi">1</span><span class="p">])</span>
    <span class="c1"># Multiply the n by s array by the corresponding attributes.</span>
    <span class="n">slopes_fitted</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">slopes_array</span> <span class="o">*</span> <span class="n">attributes</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
    <span class="n">predicted</span> <span class="o">=</span> <span class="n">intercept</span> <span class="o">+</span> <span class="n">slopes_fitted</span>
    <span class="n">errors</span> <span class="o">=</span> <span class="n">y_values</span> <span class="o">-</span> <span class="n">predicted</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">errors</span> <span class="o">**</span> <span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<p>Here we show we get exactly the same answer with this function, as we got from the <code class="docutils literal notranslate"><span class="pre">rmse</span></code> function above.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">rmse_fast</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">ckdp</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s1">&#39;Urea&#39;</span><span class="p">:],</span> <span class="n">ckdp</span><span class="p">[</span><span class="s1">&#39;Creatinine&#39;</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>6.28908245609285
</pre></div>
</div>
</div>
</div>
<p>Here we use the <code class="docutils literal notranslate"><span class="pre">rmse_fast</span></code> function with our specific data.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">rmse_for_params_fast</span><span class="p">(</span><span class="n">params</span><span class="p">):</span>
    <span class="n">intercept</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">slopes</span> <span class="o">=</span> <span class="n">params</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
    <span class="k">return</span> <span class="n">rmse_fast</span><span class="p">(</span><span class="n">intercept</span><span class="p">,</span> 
                <span class="n">slopes</span><span class="p">,</span> 
                <span class="n">ckdp</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s1">&#39;Urea&#39;</span><span class="p">:],</span>
                <span class="n">ckdp</span><span class="p">[</span><span class="s1">&#39;Creatinine&#39;</span><span class="p">]</span>
               <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>We apply the faster version of the function with minimize, to find the same
intercept and two slopes.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">min_res_fast</span> <span class="o">=</span> <span class="n">minimize</span><span class="p">(</span><span class="n">rmse_for_params_fast</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])</span>
<span class="n">min_res_fast</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>      fun: 2.2155372023697817
 hess_inv: array([[103.93633835,  -0.20878707,  -8.17471399],
       [ -0.20878707,   0.00077038,   0.01315014],
       [ -8.17471399,   0.01315014,   0.69606011]])
      jac: array([ 0.        , -0.00000083,  0.00000006])
  message: &#39;Optimization terminated successfully.&#39;
     nfev: 84
      nit: 16
     njev: 21
   status: 0
  success: True
        x: array([ 1.02389473,  0.05345681, -0.09432179])
</pre></div>
</div>
</div>
</div>
<p>Just as for the simple regression case, and <code class="docutils literal notranslate"><span class="pre">linregress</span></code>, we can get our
parameters by calculation directly, in this case we were are using
least-squares as our criterion.</p>
<p>Don’t worry about the details of the function below.  It contains the matrix
calculation to give us the same answer as <code class="docutils literal notranslate"><span class="pre">minimize</span></code> above, as long as we are
minimizing the root mean square error (or sum of squared error) for one or more
slopes and an intercept.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">multiple_regression_matrix</span><span class="p">(</span><span class="n">y_values</span><span class="p">,</span> <span class="n">x_attributes</span><span class="p">):</span>
    <span class="n">intercept_col</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">y_values</span><span class="p">))</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">column_stack</span><span class="p">([</span><span class="n">intercept_col</span><span class="p">,</span> <span class="n">x_attributes</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">pinv</span><span class="p">(</span><span class="n">X</span><span class="p">)</span> <span class="o">@</span> <span class="n">y_values</span>
</pre></div>
</div>
</div>
</div>
<p>We get the same result as we do for <code class="docutils literal notranslate"><span class="pre">minimize</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">params</span> <span class="o">=</span> <span class="n">multiple_regression_matrix</span><span class="p">(</span><span class="n">ckdp</span><span class="p">[</span><span class="s1">&#39;Creatinine&#39;</span><span class="p">],</span>
                                    <span class="n">ckdp</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s1">&#39;Urea&#39;</span><span class="p">:])</span>
<span class="n">params</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([ 1.02388056,  0.05345685, -0.09432084])
</pre></div>
</div>
</div>
</div>
<p>Finally, let’s see StatsModels in action, to do the same calculation.</p>
<p>Here we specify that we want to fit a linear model to <code class="docutils literal notranslate"><span class="pre">Creatinine</span></code> <em>as a
function of</em> <code class="docutils literal notranslate"><span class="pre">Urea</span></code> <em>and</em> as a function of <code class="docutils literal notranslate"><span class="pre">Hemoglobin</span></code>.  This has the same
meaning as above; that we will simultaneously fit the intercept, <code class="docutils literal notranslate"><span class="pre">Urea</span></code> slope
and the <code class="docutils literal notranslate"><span class="pre">Hemoglobin</span></code> slope.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">multi_model</span> <span class="o">=</span> <span class="n">smf</span><span class="o">.</span><span class="n">ols</span><span class="p">(</span><span class="n">formula</span><span class="o">=</span><span class="s2">&quot;Creatinine ~ Urea + Hemoglobin&quot;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">ckdp</span><span class="p">)</span>
<span class="n">multi_fit</span> <span class="o">=</span> <span class="n">multi_model</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>
<span class="n">multi_fit</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><table class="simpletable">
<caption>OLS Regression Results</caption>
<tr>
  <th>Dep. Variable:</th>       <td>Creatinine</td>    <th>  R-squared:         </th> <td>   0.717</td>
</tr>
<tr>
  <th>Model:</th>                   <td>OLS</td>       <th>  Adj. R-squared:    </th> <td>   0.703</td>
</tr>
<tr>
  <th>Method:</th>             <td>Least Squares</td>  <th>  F-statistic:       </th> <td>   50.70</td>
</tr>
<tr>
  <th>Date:</th>             <td>Tue, 15 Nov 2022</td> <th>  Prob (F-statistic):</th> <td>1.08e-11</td>
</tr>
<tr>
  <th>Time:</th>                 <td>20:06:54</td>     <th>  Log-Likelihood:    </th> <td> -95.221</td>
</tr>
<tr>
  <th>No. Observations:</th>      <td>    43</td>      <th>  AIC:               </th> <td>   196.4</td>
</tr>
<tr>
  <th>Df Residuals:</th>          <td>    40</td>      <th>  BIC:               </th> <td>   201.7</td>
</tr>
<tr>
  <th>Df Model:</th>              <td>     2</td>      <th>                     </th>     <td> </td>   
</tr>
<tr>
  <th>Covariance Type:</th>      <td>nonrobust</td>    <th>                     </th>     <td> </td>   
</tr>
</table>
<table class="simpletable">
<tr>
       <td></td>         <th>coef</th>     <th>std err</th>      <th>t</th>      <th>P>|t|</th>  <th>[0.025</th>    <th>0.975]</th>  
</tr>
<tr>
  <th>Intercept</th>  <td>    1.0239</td> <td>    2.416</td> <td>    0.424</td> <td> 0.674</td> <td>   -3.859</td> <td>    5.907</td>
</tr>
<tr>
  <th>Urea</th>       <td>    0.0535</td> <td>    0.007</td> <td>    8.049</td> <td> 0.000</td> <td>    0.040</td> <td>    0.067</td>
</tr>
<tr>
  <th>Hemoglobin</th> <td>   -0.0943</td> <td>    0.197</td> <td>   -0.478</td> <td> 0.635</td> <td>   -0.493</td> <td>    0.305</td>
</tr>
</table>
<table class="simpletable">
<tr>
  <th>Omnibus:</th>       <td> 1.746</td> <th>  Durbin-Watson:     </th> <td>   1.246</td>
</tr>
<tr>
  <th>Prob(Omnibus):</th> <td> 0.418</td> <th>  Jarque-Bera (JB):  </th> <td>   1.326</td>
</tr>
<tr>
  <th>Skew:</th>          <td> 0.430</td> <th>  Prob(JB):          </th> <td>   0.515</td>
</tr>
<tr>
  <th>Kurtosis:</th>      <td> 2.960</td> <th>  Cond. No.          </th> <td>    851.</td>
</tr>
</table><br/><br/>Notes:<br/>[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.</div></div>
</div>
<p>Notice again that StatsModels is doing the same calculation as above, and
finding the same result as <code class="docutils literal notranslate"><span class="pre">minimize</span></code>.</p>
</section>
<section id="multiple-regression-in-3d">
<h2>Multiple regression in 3D<a class="headerlink" href="#multiple-regression-in-3d" title="Permalink to this headline">#</a></h2>
<p>It can be useful to use a 3D plot to show what is going on here.  <code class="docutils literal notranslate"><span class="pre">minimize</span></code>
and the other methods are finding these three parameters <em>simultaneously</em>:</p>
<ul class="simple">
<li><p>An intercept;</p></li>
<li><p>A slope for <code class="docutils literal notranslate"><span class="pre">Urea</span></code></p></li>
<li><p>A slope for <code class="docutils literal notranslate"><span class="pre">Hemoglobin</span></code>.</p></li>
</ul>
<p>The plot below shows what this looks like, in 3D.  Instead of the 2D case,
where we are fitting the y data values (<code class="docutils literal notranslate"><span class="pre">Creatinine</span></code>) with a single straight
line, here we are fitting the y data values with <em>two</em> straight lines.  In 3D
these two straight lines form a plane, and we want the plane such that the sum
of squares of the distance of the y values from the plane (plotted) is as small
as possible.  <code class="docutils literal notranslate"><span class="pre">minimize</span></code> will change the intercept and the two slopes to move
this plane around until it has minimized the error.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Run this cell.</span>
<span class="kn">import</span> <span class="nn">mpl_toolkits.mplot3d</span>  <span class="c1"># (for Matplotlib &lt; 3.2)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="mi">8</span><span class="p">))</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">ckdp</span><span class="p">[</span><span class="s1">&#39;Urea&#39;</span><span class="p">],</span>
           <span class="n">ckdp</span><span class="p">[</span><span class="s1">&#39;Hemoglobin&#39;</span><span class="p">],</span>
           <span class="n">ckdp</span><span class="p">[</span><span class="s1">&#39;Creatinine&#39;</span><span class="p">]</span>
          <span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;Urea&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Hemoglobin&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_zlabel</span><span class="p">(</span><span class="s1">&#39;Creatinine&#39;</span><span class="p">)</span>
<span class="n">intercept</span><span class="p">,</span> <span class="n">urea_slope</span><span class="p">,</span> <span class="n">hgb_slope</span> <span class="o">=</span> <span class="n">min_res_fast</span><span class="o">.</span><span class="n">x</span>
<span class="n">mx_urea</span><span class="p">,</span> <span class="n">mx_hgb</span><span class="p">,</span> <span class="n">mx_creat</span> <span class="o">=</span> <span class="mi">300</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">18</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="n">mx_urea</span><span class="p">],</span>
        <span class="p">[</span><span class="n">intercept</span><span class="p">,</span> <span class="n">intercept</span> <span class="o">+</span> <span class="n">urea_slope</span> <span class="o">*</span> <span class="n">mx_urea</span><span class="p">],</span>
        <span class="mi">0</span><span class="p">,</span>
        <span class="n">zdir</span><span class="o">=</span><span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
<span class="n">mx_hgb</span> <span class="o">=</span> <span class="n">ckdp</span><span class="p">[</span><span class="s1">&#39;Hemoglobin&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="n">mx_hgb</span><span class="p">],</span>
        <span class="p">[</span><span class="n">intercept</span><span class="p">,</span> <span class="n">intercept</span> <span class="o">+</span> <span class="n">hgb_slope</span> <span class="o">*</span> <span class="n">mx_hgb</span><span class="p">],</span>
        <span class="mi">0</span><span class="p">,</span>
        <span class="n">zdir</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">)</span>
<span class="c1"># Plot the fitting plane.</span>
<span class="n">plane_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">mx_urea</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
<span class="n">plane_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">mx_hgb</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
<span class="n">X</span><span class="p">,</span> <span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">plane_x</span><span class="p">,</span> <span class="n">plane_y</span><span class="p">)</span>
<span class="n">Z</span> <span class="o">=</span> <span class="n">intercept</span> <span class="o">+</span> <span class="n">urea_slope</span> <span class="o">*</span> <span class="n">X</span> <span class="o">+</span> <span class="n">hgb_slope</span> <span class="o">*</span> <span class="n">Y</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot_surface</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">Z</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="c1"># Plot lines between each point and fitting plane</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">ckdp</span><span class="o">.</span><span class="n">iterrows</span><span class="p">():</span>
    <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">actual</span> <span class="o">=</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Urea&#39;</span><span class="p">],</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Hemoglobin&#39;</span><span class="p">],</span> <span class="n">row</span><span class="p">[</span><span class="s1">&#39;Creatinine&#39;</span><span class="p">]</span>
    <span class="n">fitted</span> <span class="o">=</span> <span class="n">intercept</span> <span class="o">+</span> <span class="n">x</span> <span class="o">*</span> <span class="n">urea_slope</span> <span class="o">+</span> <span class="n">y</span> <span class="o">*</span> <span class="n">hgb_slope</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">x</span><span class="p">,</span> <span class="n">x</span><span class="p">],</span> <span class="p">[</span><span class="n">y</span><span class="p">,</span> <span class="n">y</span><span class="p">],</span> <span class="p">[</span><span class="n">fitted</span><span class="p">,</span> <span class="n">actual</span><span class="p">],</span>
            <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;:&#39;</span><span class="p">,</span>
            <span class="n">linewidth</span><span class="o">=</span><span class="mf">0.5</span><span class="p">,</span>
            <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="c1"># Set the axis limits (and reverse y axis)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">mx_urea</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="n">mx_hgb</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_zlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">mx_creat</span><span class="p">);</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/single_multiple_69_0.png" src="../_images/single_multiple_69_0.png" />
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "lisds/textbook",
            ref: "main",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./classification"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
            </main>
            <footer class="footer-article noprint">
                
    <!-- Previous / next buttons -->
<div class='prev-next-area'>
    <a class='left-prev' id="prev-link" href="Multiple_Regression.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Multiple regression</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="../useful-pandas/crosstab.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Cross-tabulation</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
            </footer>
        </div>
    </div>
    <div class="footer-content row">
        <footer class="col footer"><p>
  
    By Matthew Brett, Ani Adhikari, John Denero, David Wagner<br/>
  
      &copy; Copyright 2022.<br/>
</p>
        </footer>
    </div>
    
</div>


      </div>
    </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/pydata-sphinx-theme.js?digest=1999514e3f237ded88cf"></script>


  </body>
</html>